let myData = {}; 
let sessionQueue = []; 
let currentWordIndex = 0;
let isAnswerShown = false;
let selectedGrade = '30';

// 各級のデータを保持するオブジェクト
const GRADE_DATA = {
    '30': [],
    '25': [],
    '20': []
};

window.onload = async function() {
    loadUserData();
    // 起動時にすべてのCSVを読み込む
    await Promise.all([
        loadCSV('30', 'Eiken_30.csv'),
        loadCSV('25', 'Eiken_25.csv'),
        loadCSV('20', 'Eiken_20.csv')
    ]);
};

async function loadCSV(gradeKey, fileName) {
    try {
        const response = await fetch(fileName);
        const text = await response.text();
        const lines = text.trim().split('\n');
        GRADE_DATA[gradeKey] = lines.map(line => {
            const [id, en, ja, cat] = line.split(',').map(s => s.trim());
            return { id: parseInt(id), en, ja, cat };
        });
    } catch (e) {
        console.error(`${fileName} の読み込みに失敗しました:`, e);
    }
}

function startSession(grade) {
    selectedGrade = grade;
    const targetList = GRADE_DATA[grade];
    // ... (以下の学習ロジックは以前のHTML全体生成時と同じ)
}
